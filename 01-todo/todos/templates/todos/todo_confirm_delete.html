{% extends 'todos/base.html' %}

{% block content %}
<style>
    .delete-warning {
        background-color: #fff3cd;
        border: 1px solid #ffc107;
        padding: 20px;
        border-radius: 4px;
        margin-bottom: 20px;
    }
    .todo-details {
        background-color: #f8f9fa;
        padding: 15px;
        border-radius: 4px;
        margin-bottom: 20px;
    }
    .form-actions {
        display: flex;
        gap: 10px;
    }
</style>

<h2>Delete Todo</h2>

<div class="delete-warning">
    <strong>Warning:</strong> Are you sure you want to delete this todo? This action cannot be undone.
</div>

<div class="todo-details">
    <h3>{{ todo.title }}</h3>
    {% if todo.description %}
    <p>{{ todo.description }}</p>
    {% endif %}
    {% if todo.due_date %}
    <p><strong>Due:</strong> <span class="local-time" data-utc="{{ todo.due_date|date:'c' }}">{{ todo.due_date|date:"Y-m-d H:i" }}</span></p>
    {% endif %}
</div>

<form method="post">
    {% csrf_token %}
    <div class="form-actions">
        <button type="submit" class="btn btn-danger">Yes, Delete</button>
        <a href="{% url 'todo_list' %}" class="btn btn-secondary">Cancel</a>
    </div>
</form>

<script>
    // Convert all UTC times to user's local timezone
    document.addEventListener('DOMContentLoaded', function() {
        const timeElements = document.querySelectorAll('.local-time');

        timeElements.forEach(function(element) {
            const utcTime = element.getAttribute('data-utc');
            if (utcTime) {
                const date = new Date(utcTime);

                // Format: YYYY-MM-DD HH:MM
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                const hours = String(date.getHours()).padStart(2, '0');
                const minutes = String(date.getMinutes()).padStart(2, '0');

                element.textContent = `${year}-${month}-${day} ${hours}:${minutes}`;
            }
        });
    });
</script>

{% endblock %}
